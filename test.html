<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>هدیه ویژه — دریافت کد</title>
  <style>
    :root{
      --bg1:#0f172a;
      --bg2:#0f254a;
      --card:#ffffff;
      --accent1:#6ee7b7;
      --accent2:#60a5fa;
      --muted:#6b7280;
    }
    *{box-sizing:border-box;font-family: "Vazirmatn", "Tahoma", sans-serif}
    html,body{height:100%;margin:0;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#0b1220}
    .wrap{
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:30px;
      background-image: radial-gradient(circle at 10% 10%, rgba(255,255,255,0.03), transparent 8%),
                        radial-gradient(circle at 90% 90%, rgba(255,255,255,0.02), transparent 8%);
    }
    .card{
      width:100%;max-width:420px;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96));
      border-radius:18px;padding:26px;box-shadow:0 10px 30px rgba(2,6,23,0.6);position:relative;overflow:hidden;
    }
    /* decorative circles */
    .card::before, .card::after{
      content:"";position:absolute;border-radius:50%;filter:blur(40px);opacity:0.12;
    }
    .card::before{width:260px;height:260px;right:-80px;top:-80px;background:linear-gradient(45deg,var(--accent1),var(--accent2))}
    .card::after{width:180px;height:180px;left:-50px;bottom:-60px;background:linear-gradient(45deg,#93c5fd,#a78bfa)}
    .logo{
      display:flex;align-items:center;gap:12px;margin-bottom:8px;
    }
    .logo .icon{
      width:60px;height:60px;border-radius:14px;background:linear-gradient(135deg,var(--accent2),var(--accent1));
      display:flex;align-items:center;justify-content:center;color:#04203a;font-weight:700;font-size:20px;
      box-shadow:0 6px 18px rgba(96,165,250,0.18);
    }
    .title{font-size:20px;font-weight:700;color:#071233}
    .subtitle{font-size:13px;color:var(--muted);margin-top:4px}
    form{margin-top:18px}
    .field{
      margin-top:14px;position:relative;
    }
    input[type="tel"]{
      width:100%;padding:14px 14px;border-radius:12px;border:1px solid rgba(7,18,51,0.06);
      font-size:16px;background:transparent;outline:none;
      box-shadow: inset 0 -6px 18px rgba(2,6,23,0.02);
      direction:ltr; /* keep digits LTR */
    }
    .hint{font-size:12px;color:var(--muted);margin-top:8px}
    .btn{
      display:inline-block;width:100%;padding:13px;border-radius:12px;text-align:center;
      background:linear-gradient(90deg,var(--accent2),var(--accent1));color:white;font-weight:700;border:0;
      font-size:16px;margin-top:16px;cursor:pointer;box-shadow:0 8px 20px rgba(37,99,235,0.18);
      transition:transform .12s ease, box-shadow .12s ease;
    }
    .btn:active{transform:translateY(1px)}
    .small{font-size:13px;color:var(--muted);margin-top:12px;text-align:center}
    .social-row{display:flex;gap:10px;justify-content:center;margin-top:14px}
    .chip{padding:8px 12px;border-radius:999px;background:rgba(3,7,18,0.03);font-size:13px}
    /* modal */
    .overlay{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;padding:20px}
    .modal{background:var(--card);padding:20px;border-radius:12px;max-width:420px;width:100%;box-shadow:0 12px 40px rgba(0,0,0,0.4)}
    .modal h3{margin:0;font-size:18px}
    .modal p{margin:10px 0 0;color:var(--muted)}
    .otp-box{
      margin-top:14px;padding:14px;border-radius:10px;background:linear-gradient(180deg,rgba(14,165,233,0.06),rgba(99,102,241,0.04));
      font-weight:700;display:flex;align-items:center;justify-content:space-between;
    }
    .otp-code{font-size:20px;letter-spacing:4px}
    .close{margin-top:14px;display:block;width:100%;padding:10px;border-radius:10px;border:1px solid rgba(7,18,51,0.06);text-align:center;background:transparent;cursor:pointer}
    /* responsive */
    @media (max-width:420px){
      .card{padding:18px;border-radius:14px}
      .logo .icon{width:52px;height:52px}
    }
    /* floating animated sparkle */
    .sparkle{position:absolute;right:18px;top:18px;font-size:12px;background:rgba(255,255,255,0.85);padding:8px;border-radius:999px;color:#0b1220}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" aria-labelledby="pageTitle">
      <div class="sparkle">هدیه ویژه</div>

      <div class="logo" aria-hidden="false">
        <div class="icon" id="brandIcon">YC</div>
        <div>
          <div class="title" id="pageTitle">کمپین هدیه یک میلیون تومانی</div>
          <div class="subtitle">برای شرکت در قرعه‌کشی، شماره همراه خود را وارد کنید</div>
        </div>
      </div>

      <form id="mobileForm" onsubmit="return false;" aria-describedby="hint">
        <div class="field">
          <label for="mobile" style="font-size:13px;color:#0b1220;display:block;margin-bottom:6px">شماره موبایل</label>
          <input id="mobile" type="tel" inputmode="numeric" pattern="[0-9]*" autocomplete="tel" placeholder="مثال: 09123456789" aria-required="true" />
          <div class="hint" id="hint">شماره موبایل باید با 09 شروع و 10 رقم باشد.</div>
        </div>

        <button id="sendBtn" class="btn" type="submit" onclick="handleSend()">دریافت کد</button>

        <div class="small">با ارسال شماره، قوانین و شرایط کمپین را می‌پذیرید.</div>
        <div class="social-row" aria-hidden="true">
          <div class="chip">قرعه‌کشی هفته‌ای</div>
          <div class="chip">ارسال پیامک امن</div>
          <div class="chip">پشتیبانی ۲۴ ساعته</div>
        </div>
      </form>
    </div>
  </div>

  <!-- modal -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal">
      <h3 id="modalTitle">کد فعال‌سازی ارسال شد</h3>
      <p id="modalSub">کد به شماره <strong id="modalNumber"></strong> ارسال شد. لطفاً کد ۶ رقمی را وارد کنید.</p>

      <div class="otp-box" role="status" aria-live="polite">
        <div>
          <div style="font-size:12px;color:var(--muted)">کد نمونه (برای تست):</div>
          <div class="otp-code" id="otpCode">— — — — — —</div>
        </div>
        <div style="text-align:left">
          <div style="font-size:12px;color:var(--muted)">زمان باقی‌مانده</div>
          <div id="timer" class="chip">00:59</div>
        </div>
      </div>

      <button class="close" onclick="closeModal()">باشه، متوجه شدم</button>
    </div>
  </div>

  <script>
    // ساده‌سازی: اعتبارسنجی شماره موبایل ایران (09XXXXXXXXX)
    const mobileInput = document.getElementById('mobile');
    const overlay = document.getElementById('overlay');
    const modalNumber = document.getElementById('modalNumber');
    const otpCodeEl = document.getElementById('otpCode');
    const timerEl = document.getElementById('timer');
    const sendBtn = document.getElementById('sendBtn');

    function isValidIranMobile(s){
      // اجازه می‌دهیم اعداد لاتین یا فارسی وارد شوند؛ ابتدا تبدیل به لاتین
      if(!s) return false;
      // replace persian digits
      const persian = {'۰':'0','۱':'1','۲':'2','۳':'3','۴':'4','۵':'5','۶':'6','۷':'7','۸':'8','۹':'9'};
      s = s.replace(/[۰-۹]/g, d => persian[d]);
      s = s.replace(/\s|\-|\(|\)/g,'');
      return /^09\d{9}$/.test(s);
    }

    function generateOTP(){
      // تولید یک کد 6 رقمی شبیه‌سازی‌شده (برای تست)
      return Math.floor(100000 + Math.random()*900000).toString();
    }

    let countdownInterval = null;
    function startTimer(seconds){
      clearInterval(countdownInterval);
      let t = seconds;
      updateTimer(t);
      countdownInterval = setInterval(()=>{
        t--;
        if(t<=0){ clearInterval(countdownInterval); updateTimer(0); return; }
        updateTimer(t);
      },1000);
    }
    function updateTimer(t){
      const mm = String(Math.floor(t/60)).padStart(2,'0');
      const ss = String(t%60).padStart(2,'0');
      timerEl.textContent = `${mm}:${ss}`;
    }

    function handleSend(){
      const val = mobileInput.value.trim();
      if(!isValidIranMobile(val)){
        alert('لطفاً یک شماره موبایل معتبر وارد کنید: مثلا 09123456789');
        mobileInput.focus();
        return;
      }
      // disable button briefly
      sendBtn.disabled = true;
      sendBtn.textContent = 'در حال ارسال...';

      // TODO: اینجا باید با API ارسال پیامک واقعی (از سرویس رسمی) تماس برقرار شود.
      // مثال (نمایشی، کار نمی‌کند): fetch('/api/send-otp', {method:'POST', body: JSON.stringify({mobile:val})})
      // پس از دریافت پاسخ موفق، مودال را نمایش دهید.

      // شبیه‌سازی تاخیر و نمایش مودال
      setTimeout(()=>{
        const otp = generateOTP();
        modalNumber.textContent = val.replace(/[۰-۹]/g, d => ({'۰':'0','۱':'1','۲':'2','۳':'3','۴':'4','۵':'5','۶':'6','۷':'7','۸':'8','۹':'9'})[d]) ;
        otpCodeEl.textContent = otp;
        overlay.style.display = 'flex';
        startTimer(60); // 60 ثانیه
        sendBtn.disabled = false;
        sendBtn.textContent = 'دریافت کد';
      },900);

      // توجه: در پیاده‌سازی واقعی:
      // 1) از سرویس پیامک معتبر استفاده کنید.
      // 2) شماره را در سمت سرور دوباره اعتبارسنجی کنید.
      // 3) کد تولید شده را در سرور نگه دارید و اعتبارسنجی کنید (نه فقط در کلاینت).
    }

    function closeModal(){
      overlay.style.display = 'none';
      clearInterval(countdownInterval);
    }

    // این امکان را می‌دهیم با Enter هم فرم ارسال شود
    mobileInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){ handleSend(); e.preventDefault(); }
    });

    // پیشنهاد: اگر می‌خواهی لوگو یا نام را تغییر دهی:
    // document.getElementById('brandIcon').textContent = 'ML';
    // document.getElementById('pageTitle').textContent = 'نام کمپین شما';

    // برای تجربه بهتر: اجازه بده مرورگر فقط ارقام وارد کند
    mobileInput.addEventListener('input', ()=>{
      // حذف حروف غیرعددی (به جز فارسی)
      let v = mobileInput.value;
      v = v.replace(/[^\d۰-۹\s\-\(\)]/g,'');
      if(v.length>13) v = v.slice(0,13);
      mobileInput.value = v;
    });
  </script>
</body>
</html>
